<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
    <div class="container-fluid bg-1 text-center">
    <form>
        <label for="fname">Ievadiet skaitli!</label><br>
        <input value="4" type="number" id="quantity" name="quantity" min="1" max="5">
        <input type = "button" onclick="veidotkvadratu(quantity.value)" value="Jaunas spēles sākums"> 
        <label id="minutes">00</label>:<label id="seconds">00</label>
    </form> 
    <script>
        
    var jauns = [];
    var masivs = [];
    var bilde, teksts, atverti=0;
    
    function veidotkvadratu(n){
        var timeVar =setInterval(setTime, 1000);
        veidotmasivu();
        sajauktmasivu();
        jaunsmasivs(n);
        sajauktjauns();
        var i;
        var k=0;
        var pip=0;
        let ieprieks;
        if(document.getElementById("laukums")!= null){
            document.body.removeChild(document.getElementById("laukums"));
        }
        let p = document.createElement("div");
        p.setAttribute("id","laukums");    
        for (i=0; i<n;i++){                 
            let y = document.createElement("div");
            for (let m=0; m<n;m++){
                let x = document.createElement("BUTTON");
                x.className = 'button';
                let nr=n*i+m;
                if(jauns[nr].indexOf(".")>=0){
                    x.setAttribute("id", "bpoga"+(nr));
                    x.setAttribute("style","background-image: url("+jauns[nr]+")"); 
                    x.setAttribute("style", "background-color:#2f2f2f");
                }else{
                    x.setAttribute("id", "tpoga"+(nr));
                    x.innerHTML=jauns[nr];
                    x.setAttribute("style", "color:#2f2f2f");
                }
                var cipars;
                x.onclick=()=>{
                    console.log(x.id);
                    var rr= x.id.substring(5);
                    if(x.id.indexOf("b")>=0){
                        x.setAttribute("style","background-image: url("+jauns[rr]+")");
                        bilde = setTimeout(function(){x.setAttribute("style","background-color:#2f2f2f");},2000);
                    }else{
                        x.setAttribute("style", "color:white");
                        x.innerHTML=jauns[rr];
                        teksts = setTimeout(function(){ x.setAttribute("style", "color:#2f2f2f");},2000);
                    } 
                    if(pip%2==0){
                        ieprieks=x.id;
                        console.log(ieprieks);
                        let {rinda, kolonna} = matrixIndexed(masivs, jauns[rr]);
                        console.log( rinda, kolonna);
                        cipars = rinda;
                    }else{
                        let {rinda, kolonna} = matrixIndexed(masivs, jauns[rr]);
                        console.log(rinda, kolonna);
                        if(cipars!=rinda){
                            if(x.id.indexOf("b")>=0){
                                setTimeout(function(){ x.setAttribute("style", "background-color:#2f2f2f");}, 1000);
                            }else{
                                x.setAttribute("style", "color:#2f2f2f");
                                setTimeout(function(){ x.innerHTML=jauns[rr];}, 1000);
                            }
                        }else{
                            if(x.id.indexOf("b")>=0){
                                stopteksts();
                                stopbilde();
                                atverti=atverti+2;
                                if(atverti==n*n){
                                   clearInterval(timeVar);
                                   atrisinata();
                                   setTimeout(function(){ location.reload();},2000);
                                }
                            }else{
                                stopbilde();
                                stopteksts();
                                atverti=atverti+2;
                                if(atverti==n*n){
                                   clearInterval(timeVar);
                                   atrisinata();
                                   setTimeout(function(){ location.reload();},2000);
                                }
                            }
                        }
                    }
                    pip++;
                }    
                y.appendChild(x);
            }
            p.appendChild(y);
            k=k+n;
        } 
        document.body.appendChild(p);
    }
    
    
    function atrisinata() {
        alert("Viss kārtībā!");
    }
    
    function stopteksts() {
        clearTimeout(teksts);
    }
    
    function stopbilde() {
        clearTimeout(bilde);
    }
    
    var minutesLabel = document.getElementById("minutes");
    var secondsLabel = document.getElementById("seconds");
    var totalSeconds = 0;
    
    
    function setTime() {
       ++totalSeconds;
       secondsLabel.innerHTML = pad(totalSeconds % 60);
       minutesLabel.innerHTML = pad(parseInt(totalSeconds / 60));
    }
    
    function pad(val) {
        var valString = val + "";
        if (valString.length < 2) {
           return "0" + valString;
        }else{
            return valString;
        }
    }
    
    
    function matrixIndexed(masivs, name) {
        var rinda;
        var kolonna;
        for (rinda = 0; rinda < masivs.length; ++rinda) { 
            const nsDetails = masivs[rinda];
            for (kolonna = 0; kolonna < nsDetails.length; ++kolonna) {
                const tempObject = nsDetails[kolonna];
                if (tempObject === name) {  
                    return {rinda, kolonna};
                }
            }
        }
        return {};
    }
    
    
    var attels = ['pukes/1.jpg', 'pukes/2.jpg', 'pukes/3.jpg', 'pukes/4.jpg', 'pukes/5.jpg', 'pukes/6.jpg',
        'pukes/7.jpg', 'pukes/8.jpg', 'pukes/9.jpg', 'pukes/10.jpg', 'pukes/11.jpg', 'pukes/12.jpg',
        'pukes/13.jpg', 'pukes/14.jpg', 'pukes/15.jpg', 'pukes/16.jpg', 'pukes/17.jpg', 'pukes/18.jpg',
        'pukes/19.jpg', 'pukes/20.jpg', 'pukes/21.jpg', 'pukes/22.jpg', 'pukes/23.jpg', 'pukes/24.jpg',
        'pukes/25.jpg', 'pukes/26.jpg', 'pukes/27.jpg', 'pukes/28.jpg', 'pukes/29.jpg', 'pukes/30.jpg', 
        'pukes/31.jpg', 'pukes/32.jpg', 'pukes/33.jpg', 'pukes/34.jpg', 'pukes/35.jpg', 'pukes/36.jpg',
        'pukes/37.jpg', 'pukes/38.jpg', 'pukes/39.jpg', 'pukes/40.jpg', 'pukes/41.jpg', 'pukes/42.jpg',
        'pukes/43.jpg', 'pukes/44.jpg', 'pukes/45.jpg', 'pukes/46.jpg', 'pukes/47.jpg', 'pukes/48.jpg',
        'pukes/49.jpg', 'pukes/50.jpg'];
        
    var pukes = ["Parastā pīpene", "Elegantā zefirante", "Rudbekija", "Narcise", "Krizantēma", "Zilsniedzīte",
        "Anemone", "Rudzupuķe", "Magone", "Tulpe", "Astere", "Cinnija", "Floksis", "Peonija", "Lillija",
        "Dālija", "Ūdensroze", "Īriss", "Vēlziede", "Dienziede", "Kolorado kolumbīna", "Hortenzija", 
        "Maijpuķīte", "Kalla lillija", "Lauztā sirds", "Lantana", "Ashanti asinszieds", "Begonija",
        "Sarkanais jasmīns", "Dendrobiums", "Sniegpulkstenīte", "Pienpulkstenīte", "Krokuss", "Ziemziede", 
        "Vizbulīte", "Erantes", "Lakacis", "Māllēpe", "Muskare", "Zeltstarīte", "Silpurene", "Purene",
        "Prīmula", "Adonīss", "Roze", "Saulespuķe", "Orhideja", "Neaizmirstulīte", "Hiacinte", "Mārtiņroze"];
    
    
    function veidotmasivu(){
        for (let i = 0; i < attels.length; i++) {
            let m1 =[];
            m1.push(attels[i]);
            m1.push(pukes[i]);
            masivs.push(m1);
        }
    }
    
    function jaunsmasivs(n){
        let p=(n*n)/2;
        let a;
        for(let r=0; r<p; r++){
            for(let s=0;s<2;s++){
                a=masivs[r][s];
                console.log(a);
                jauns.push(a);
            }
        }
        console.log("viss");  
    }
    
    function sajauktjauns(){
        for(let i=0;i<jauns.length;i++){
            let rand=Math.floor(Math.random()*jauns.length);
            let tmp=jauns[i];
            jauns[i]=jauns[rand];
            jauns[rand]=tmp;
        }
        for(let i=0;i<jauns.length;i++){
            console.log(jauns[i]);
        }
    }
    
    var a, a1, b, b1;
    
    function sajauktmasivu(){
        for(var k=0;k<50;k++){
           var t=Math.floor(Math.random() * 49);
           var p=Math.floor(Math.random() * 49);
           a=masivs[t][0];
           a1=masivs[t][1];
           b=masivs[p][0];
           b1=masivs[p][1];
           masivs[p][0]=a;
           masivs[p][1]=a1;
           masivs[t][0]=b;
           masivs[t][1]=b1;
        }
    }
</script>
    </div>
    </body>
</html>
